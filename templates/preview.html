<div class="preview-card">
    <div class="preview-header">
        <h5>üìã Anteprima Report</h5>
    </div>
    <div class="preview-body">
        <div class="preview-grid">
            <div class="preview-section">
                <h6>Configurazione:</h6>
                <ul class="preview-list">
                    <li><strong>Sensori:</strong> {{ data.num_sensors }}</li>
                    <li><strong>Vendor:</strong> {{ data.vendor }}</li>
                    <li><strong>Device ID:</strong> {{ data.device_id }}</li>
                    <li><strong>Data Test:</strong> {{ data.start_date_formatted }}</li>
                    <!-- NUOVO: Mostra stato Downlink -->
                    <li><strong>Scenario Downlink:</strong> 
                        {% if data.enable_downlink %}
                            <span style="color: #28a745;">‚úÖ Abilitato</span>
                        {% else %}
                            <span style="color: #dc3545;">‚ùå Disabilitato</span>
                        {% endif %}
                    </li>
                </ul>
            </div>
            <div class="preview-section">
                <h6>Parametri che verranno inseriti:</h6>
                <ul class="preview-list">
                    <li><strong>{deviceId}=</strong><code>{{ transformed_device_id }}</code></li>
                    <li><strong>Range Metriche:</strong> {{ metrics.range_metriche }}</li>
                    <li><strong>Allarme Metriche:</strong> {{ metrics.allarme_metriche }}</li>
                    <li><strong>Allarmi:</strong> {{ metrics.allarmi }}</li>
                </ul>
            </div>
        </div>
        
        <div class="alert alert-success">
            ‚úÖ Configurazione valida! Il report conterr√† 
            {% if data.enable_downlink %}
                4 sheet con tutti i parametri aggiornati automaticamente.
            {% else %}
                3 sheet (Downlink escluso) con tutti i parametri aggiornati automaticamente.
            {% endif %}
        </div>
    </div>
</div>